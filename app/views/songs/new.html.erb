<html>
  <head>
    <meta charset="utf-8">
    <title>Uppy</title>
    <link href="https://transloadit.edgly.net/releases/uppy/v1.20.2/uppy.min.css" rel="stylesheet">
  </head>
  <body>
  <%= link_to 'go back', songs_path %>
    <% if @song.errors.any? %>
    <ul>
      <% @song.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  <% end %>
  <%= form_with model: @song, url: songs_path, method: 'post', local: true do |f| %>
    <div>
    <%= f.label :image %>
    <%= f.hidden_field :image, value: @song.cached_image_data%>
    <%= f.file_field :image %>
    </div>
    <div>
    <%= f.label :name %>
    <%= f.text_field :name %>
    </div>
    <div>
    <%= f.label :intro %>
    <%= f.text_field :intro %>
    </div>
    <div>
    <%= f.label :track %>
    <%= f.file_field :track %>
    </div>
    <%= f.submit %>     
  <% end %>


    <div id="drag-drop-area"></div>

    <script src="https://transloadit.edgly.net/releases/uppy/v1.20.2/uppy.min.js"></script>
    <script>
      var uppy = Uppy.Core()
        .use(Uppy.Dashboard, {
          inline: true,
          target: '#drag-drop-area'
        })
        .use(Uppy.Tus, {endpoint: 'https://master.tus.io/files/'})

      uppy.on('complete', (result) => {
        console.log('Upload complete! Weâ€™ve uploaded these files:', result.successful)
      })
    </script>
  </body>
</html>
